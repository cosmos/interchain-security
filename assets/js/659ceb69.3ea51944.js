"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9091],{5956:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>c});var s=i(5893),r=i(1151);const t={sidebar_position:3,toc_min_heading_level:2,toc_max_heading_level:5},d="x/ccv/consumer",a={id:"build/modules/consumer",title:"x/ccv/consumer",description:"Overview",source:"@site/docs/build/modules/03-consumer.md",sourceDirName:"build/modules",slug:"/build/modules/consumer",permalink:"/interchain-security/build/modules/consumer",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,toc_min_heading_level:2,toc_max_heading_level:5},sidebar:"tutorialSidebar",previous:{title:"x/ccv/provider",permalink:"/interchain-security/build/modules/provider"},next:{title:"x/ccv/democracy",permalink:"/interchain-security/build/modules/democracy"}},o={},c=[{value:"Overview",id:"overview",level:2},{value:"State",id:"state",level:2},{value:"Provider Connection",id:"provider-connection",level:3},{value:"ProviderClientID",id:"providerclientid",level:4},{value:"ProviderChannelID",id:"providerchannelid",level:4},{value:"Changeover",id:"changeover",level:3},{value:"PreCCV",id:"preccv",level:4},{value:"InitialValSet",id:"initialvalset",level:4},{value:"InitGenesisHeight",id:"initgenesisheight",level:4},{value:"PrevStandaloneChain",id:"prevstandalonechain",level:4},{value:"Validator Updates",id:"validator-updates",level:3},{value:"PendingChanges",id:"pendingchanges",level:4},{value:"CrossChainValidator",id:"crosschainvalidator",level:4},{value:"HistoricalInfo",id:"historicalinfo",level:4},{value:"Reward Distribution",id:"reward-distribution",level:3},{value:"LastDistributionTransmission",id:"lastdistributiontransmission",level:4},{value:"Downtime Infractions",id:"downtime-infractions",level:3},{value:"OutstandingDowntime",id:"outstandingdowntime",level:4},{value:"HeightValsetUpdateID",id:"heightvalsetupdateid",level:4},{value:"PendingPacketsIndex",id:"pendingpacketsindex",level:4},{value:"PendingDataPacketsV1",id:"pendingdatapacketsv1",level:4},{value:"SlashRecord",id:"slashrecord",level:4},{value:"State Transitions",id:"state-transitions",level:2},{value:"IBC Callbacks",id:"ibc-callbacks",level:2},{value:"OnChanOpenInit",id:"onchanopeninit",level:3},{value:"OnChanOpenTry",id:"onchanopentry",level:3},{value:"OnChanOpenAck",id:"onchanopenack",level:3},{value:"OnChanOpenConfirm",id:"onchanopenconfirm",level:3},{value:"OnChanCloseInit",id:"onchancloseinit",level:3},{value:"OnChanCloseConfirm",id:"onchancloseconfirm",level:3},{value:"OnRecvPacket",id:"onrecvpacket",level:3},{value:"OnAcknowledgementPacket",id:"onacknowledgementpacket",level:3},{value:"OnTimeoutPacket",id:"ontimeoutpacket",level:3},{value:"Messages",id:"messages",level:2},{value:"MsgUpdateParams",id:"msgupdateparams",level:3},{value:"BeginBlock",id:"beginblock",level:2},{value:"EndBlock",id:"endblock",level:2},{value:"Hooks",id:"hooks",level:2},{value:"Events",id:"events",level:2},{value:"Parameters",id:"parameters",level:2},{value:"Enabled",id:"enabled",level:3},{value:"BlocksPerDistributionTransmission",id:"blocksperdistributiontransmission",level:3},{value:"DistributionTransmissionChannel",id:"distributiontransmissionchannel",level:3},{value:"ProviderFeePoolAddrStr",id:"providerfeepooladdrstr",level:3},{value:"CcvTimeoutPeriod",id:"ccvtimeoutperiod",level:3},{value:"TransferTimeoutPeriod",id:"transfertimeoutperiod",level:3},{value:"ConsumerRedistributionFraction",id:"consumerredistributionfraction",level:3},{value:"HistoricalEntries",id:"historicalentries",level:3},{value:"UnbondingPeriod",id:"unbondingperiod",level:3},{value:"SoftOptOutThreshold",id:"softoptoutthreshold",level:3},{value:"RewardDenoms",id:"rewarddenoms",level:3},{value:"ProviderRewardDenoms",id:"providerrewarddenoms",level:3},{value:"RetryDelayPeriod",id:"retrydelayperiod",level:3},{value:"Client",id:"client",level:2},{value:"CLI",id:"cli",level:3},{value:"Query",id:"query",level:4},{value:"Next Fee Distribution",id:"next-fee-distribution",level:5},{value:"Provider Info",id:"provider-info",level:5},{value:"Throttle State",id:"throttle-state",level:5},{value:"Params",id:"params",level:5},{value:"gRPC",id:"grpc",level:3},{value:"Next Fee Distribution",id:"next-fee-distribution-1",level:4},{value:"Provider Info",id:"provider-info-1",level:4},{value:"Throttle State",id:"throttle-state-1",level:4},{value:"Params",id:"params-1",level:4},{value:"REST",id:"rest",level:3},{value:"Next Fee Distribution",id:"next-fee-distribution-2",level:4},{value:"Provider Info",id:"provider-info-2",level:4},{value:"Throttle State",id:"throttle-state-2",level:4},{value:"Params",id:"params-2",level:4}];function l(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components},{Details:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"xccvconsumer",children:"x/ccv/consumer"}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"The ICS consumer module enables consumer chains to use stake locked on a provider chain\nas collateral for their own proof-of-stake based block production."}),"\n",(0,s.jsx)(n.p,{children:"The consumer module established a IBC ordered channel to the provider chain.\nThis channel is used by the provider chain to regularly send validator updates to the consumer chain.\nThe consumer sends these updates to its own consensus engine.\nThis means that the consumer module acts as a staking module of the consumer chain."}),"\n",(0,s.jsx)(n.p,{children:"Regularly, the consumer module sends a part of the consumer chain's block rewards\nto the provider chain as ICS rewards."}),"\n",(0,s.jsx)(n.p,{children:"If one of the validators in the consumer chain's validator set is missing enough blocks (i.e., downtime infraction),\nthe consumer module notifies the provider chain by sending an IBC packet to the provider module.\nAs a result, the misbehaving validator is punished on the provider chain."}),"\n",(0,s.jsx)(n.h2,{id:"state",children:"State"}),"\n",(0,s.jsxs)(n.p,{children:["For clarity, the description of the consumer module state is split into features.\nFor a more accurate description, check out the ",(0,s.jsx)(n.code,{children:"x/ccv/consumer/types/keys.go"})," file, which contains the definitions of all the keys."]}),"\n",(0,s.jsx)(n.h3,{id:"provider-connection",children:"Provider Connection"}),"\n",(0,s.jsx)(n.h4,{id:"providerclientid",children:"ProviderClientID"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"ProviderClientID"})," is the ID of the provider client on which the CCV channel is built."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(3) -> string"})]}),"\n",(0,s.jsx)(n.h4,{id:"providerchannelid",children:"ProviderChannelID"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"ProviderChannelID"})," is the ID of the CCV channel."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(4) -> string"})]}),"\n",(0,s.jsx)(n.h3,{id:"changeover",children:"Changeover"}),"\n",(0,s.jsx)(n.h4,{id:"preccv",children:"PreCCV"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"PreCCV"})," is the flag set when the consumer chain is in the process of a standalone to consumer chain changeover."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(7) -> uint64"})]}),"\n",(0,s.jsx)(n.h4,{id:"initialvalset",children:"InitialValSet"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"InitialValSet"})," is the initial validator set on the consumer chain."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(8) -> GenesisState"})]}),"\n",(0,s.jsxs)(n.p,{children:["Note that only the ",(0,s.jsx)(n.code,{children:"InitialValSet"})," field of the ",(0,s.jsx)(n.code,{children:"ProviderInfo"})," field of ",(0,s.jsx)(n.code,{children:"GenesisState"})," is set, i.e.,"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-proto",children:"message GenesisState {\n  ...\n  ProviderInfo provider = 14\n      [ (gogoproto.nullable) = false ];\n}\n\nmessage ProviderInfo {\n  // InitialValset filled in on new chain and on restart.\n  repeated .tendermint.abci.ValidatorUpdate initial_val_set = 3\n      [ (gogoproto.nullable) = false ];\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"initgenesisheight",children:"InitGenesisHeight"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"InitGenesisHeight"})," is the height when the consumer module was initialized (i.e., the ",(0,s.jsx)(n.code,{children:"InitGenesis"})," method was called)."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(17) -> uint64"})]}),"\n",(0,s.jsx)(n.h4,{id:"prevstandalonechain",children:"PrevStandaloneChain"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"PrevStandaloneChain"})," is the flag set when the consumer chain was previously a standalone chain."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(19) -> []byte{}"})]}),"\n",(0,s.jsx)(n.h3,{id:"validator-updates",children:"Validator Updates"}),"\n",(0,s.jsx)(n.h4,{id:"pendingchanges",children:"PendingChanges"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"PendingChanges"})," are the validator updates received from the provider that were not yet sent to the consensus engine."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(5) -> ValidatorSetChangePacketData"})]}),"\n",(0,s.jsxs)(n.p,{children:["Note that only the ",(0,s.jsx)(n.code,{children:"ValidatorUpdates"})," field of ",(0,s.jsx)(n.code,{children:"ValidatorSetChangePacketData"})," is set."]}),"\n",(0,s.jsx)(n.h4,{id:"crosschainvalidator",children:"CrossChainValidator"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"CrossChainValidator"})," is the internal state of a consumer validator with consensus address ",(0,s.jsx)(n.code,{children:"addr"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(16) | addr -> CrossChainValidator"}),", where ",(0,s.jsx)(n.code,{children:"CrossChainValidator"})," is defined as"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-proto",children:'message CrossChainValidator {\n  bytes address = 1;\n  int64 power = 2;\n  // pubkey is the consensus public key of the validator, as a Protobuf Any.\n  google.protobuf.Any pubkey = 3 [\n    (cosmos_proto.accepts_interface) = "cosmos.crypto.PubKey",\n    (gogoproto.moretags) = "yaml:\\"consensus_pubkey\\""\n  ];\n  // deprecated\n  bool opted_out = 4 [deprecated = true];\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"historicalinfo",children:"HistoricalInfo"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"HistoricalInfo"})," is the header and validator information for a given block.\nFor more details, see the ",(0,s.jsx)(n.a,{href:"https://docs.cosmos.network/v0.50/build/modules/staking#historicalinfo",children:"Cosmos SDK docs"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(11) | height -> HistoricalInfo"}),", where ",(0,s.jsx)(n.code,{children:"HistoricalInfo"})," is defined in the staking module as"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-proto",children:"message HistoricalInfo {\n  tendermint.types.Header header = 1 [(gogoproto.nullable) = false, (amino.dont_omitempty) = true];\n  repeated Validator      valset = 2 [(gogoproto.nullable) = false, (amino.dont_omitempty) = true];\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"reward-distribution",children:"Reward Distribution"}),"\n",(0,s.jsx)(n.h4,{id:"lastdistributiontransmission",children:"LastDistributionTransmission"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"LastDistributionTransmission"})," is the block height of the last attempt to send ICS rewards to the provider module."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(1) -> LastTransmissionBlockHeight"}),", where ",(0,s.jsx)(n.code,{children:"LastTransmissionBlockHeight"})," is defined as"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-proto",children:"message LastTransmissionBlockHeight { \n  int64 height = 1; \n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"downtime-infractions",children:"Downtime Infractions"}),"\n",(0,s.jsx)(n.h4,{id:"outstandingdowntime",children:"OutstandingDowntime"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OutstandingDowntime"})," is the flag set when a ",(0,s.jsx)(n.code,{children:"SlashPacket"})," is queued to be sent to the provider for a downtime infraction of a validator with consensus address ",(0,s.jsx)(n.code,{children:"addr"}),".\nThe flag is unset when receiving from the provider a ",(0,s.jsx)(n.code,{children:"VSCPacket"})," with a slash acknowledgement (see ",(0,s.jsx)(n.code,{children:"SlashAcks"})," in ",(0,s.jsx)(n.code,{children:"ValidatorSetChangePacketData"}),")."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(14) | addr -> []byte{}"})]}),"\n",(0,s.jsx)(n.h4,{id:"heightvalsetupdateid",children:"HeightValsetUpdateID"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"HeightValsetUpdateID"})," is the validator set update ID associated with a block height."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(13) | height -> uint64"})]}),"\n",(0,s.jsx)(n.h4,{id:"pendingpacketsindex",children:"PendingPacketsIndex"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"PendingPacketsIndex"})," is the next index available to store packet data to be sent to the provider chain (see below)."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(20) -> uint64"})]}),"\n",(0,s.jsx)(n.h4,{id:"pendingdatapacketsv1",children:"PendingDataPacketsV1"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"PendingDataPacketsV1"})," is the queue of packet data to be sent to the provider chain.\nIn general, packets in this queue will be sent to the provider in the end blocker, unless"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"the CCV channel is not yet established;"}),"\n",(0,s.jsx)(n.li,{children:"the provider client is expired;"}),"\n",(0,s.jsx)(n.li,{children:"the last slash packet sent was not yet acknowledged by the provider chain."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(15) | index -> ConsumerPacketData"}),", where ",(0,s.jsx)(n.code,{children:"index"})," is the index of the packet in the queue and ",(0,s.jsx)(n.code,{children:"ConsumerPacketData"})," is defined as"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-proto",children:"message ConsumerPacketData {\n  ConsumerPacketDataType type = 1;\n\n  oneof data {\n    SlashPacketData slashPacketData = 2;\n    VSCMaturedPacketData vscMaturedPacketData = 3;\n  }\n}\n"})}),"\n",(0,s.jsx)(n.h4,{id:"slashrecord",children:"SlashRecord"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"SlashRecord"})," is the record storing the state of a SlashPacket sent to the provider chain that was not yet acknowledged.\nSee ",(0,s.jsx)(n.a,{href:"/interchain-security/adrs/adr-008-throttle-retries",children:"ADR 008"})," for more details."]}),"\n",(0,s.jsxs)(n.p,{children:["Format: ",(0,s.jsx)(n.code,{children:"byte(21) -> SlashRecord"}),", where ",(0,s.jsx)(n.code,{children:"SlashRecord"})," is defined as"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-proto",children:"message SlashRecord {\n  bool waiting_on_reply = 1;\n  google.protobuf.Timestamp send_time = 2\n      [ (gogoproto.stdtime) = true, (gogoproto.nullable) = false ];\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"state-transitions",children:"State Transitions"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"TBA"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"ibc-callbacks",children:"IBC Callbacks"}),"\n",(0,s.jsxs)(n.p,{children:["The consumer module is an IBC application that implements the ",(0,s.jsx)(n.a,{href:"https://ibc.cosmos.network/v8/ibc/apps/apps/#create-a-custom-ibc-application-module",children:"IBC module callback"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"onchanopeninit",children:"OnChanOpenInit"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OnChanOpenInit"})," first verifies that the CCV channel was not already created.\nThen, it validates the channel parameters -- an ordered IBC channel connected on the ",(0,s.jsx)(n.code,{children:"consumer"})," port\nand with the counterparty port set to ",(0,s.jsx)(n.code,{children:"provider"})," -- and asserts that the version matches the expected version\n(only version ",(0,s.jsx)(n.code,{children:"1"})," is supported)."]}),"\n",(0,s.jsx)(n.p,{children:"Finally, it verifies that the underlying client is the expected client of the provider chain\n(i.e., provided in the consumer module genesis state)."}),"\n",(0,s.jsx)(n.h3,{id:"onchanopentry",children:"OnChanOpenTry"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OnChanOpenTry"})," returns an error. ",(0,s.jsx)(n.code,{children:"MsgChannelOpenTry"})," should be sent to the provider."]}),"\n",(0,s.jsx)(n.h3,{id:"onchanopenack",children:"OnChanOpenAck"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OnChanOpenAck"})," first verifies that the CCV channel was not already created.\nThen it verifies that the counterparty version matches the expected version\n(only version ",(0,s.jsx)(n.code,{children:"1"})," is supported)."]}),"\n",(0,s.jsxs)(n.p,{children:["If the verification passes, it stores the ",(0,s.jsx)(n.a,{href:"#providerfeepooladdrstr",children:"ProviderFeePoolAddr"})," in the state."]}),"\n",(0,s.jsxs)(n.p,{children:["Finally, if the ",(0,s.jsx)(n.a,{href:"#distributiontransmissionchannel",children:"DistributionTransmissionChannel"})," parameter is not set,\nit initiates the opening handshake for a token transfer channel over the same connection as the CCV channel\nby calling the ",(0,s.jsx)(n.code,{children:"ChannelOpenInit"})," method of the IBC module."]}),"\n",(0,s.jsx)(n.h3,{id:"onchanopenconfirm",children:"OnChanOpenConfirm"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OnChanOpenConfirm"})," returns an error. ",(0,s.jsx)(n.code,{children:"MsgChanOpenConfirm"})," should be sent to the provider."]}),"\n",(0,s.jsx)(n.h3,{id:"onchancloseinit",children:"OnChanCloseInit"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OnChanCloseInit"})," allows relayers to close duplicate OPEN channels, if the channel handshake is completed."]}),"\n",(0,s.jsx)(n.h3,{id:"onchancloseconfirm",children:"OnChanCloseConfirm"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OnChanCloseConfirm"})," is a no-op."]}),"\n",(0,s.jsx)(n.h3,{id:"onrecvpacket",children:"OnRecvPacket"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OnRecvPacket"})," unmarshals the IBC packet data into a ",(0,s.jsx)(n.code,{children:"ValidatorSetChangePacketData"})," struct (see below) and executes the handling logic."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"If it is the first packet received, sets the underlying IBC channel as the canonical CCV channel."}),"\n",(0,s.jsx)(n.li,{children:"Collects validator updates to be sent to the consensus engine at the end of the block."}),"\n",(0,s.jsxs)(n.li,{children:["Store in state the block height to VSC id (i.e., ",(0,s.jsx)(n.code,{children:"valset_update_id"}),") mapping."]}),"\n",(0,s.jsxs)(n.li,{children:["Removed the outstanding downtime flags from the validator for which the jailing\nfor downtime infractions was acknowledged by the provider chain (see the ",(0,s.jsx)(n.code,{children:"slash_acks"})," field in ",(0,s.jsx)(n.code,{children:"ValidatorSetChangePacketData"}),")."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-proto",children:'message ValidatorSetChangePacketData {\n  repeated .tendermint.abci.ValidatorUpdate validator_updates = 1 [\n    (gogoproto.nullable) = false,\n    (gogoproto.moretags) = "yaml:\\"validator_updates\\""\n  ];\n  uint64 valset_update_id = 2;\n  // consensus address of consumer chain validators\n  // successfully jailed on the provider chain\n  repeated string slash_acks = 3;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"onacknowledgementpacket",children:"OnAcknowledgementPacket"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OnAcknowledgementPacket"})," enables the consumer module to confirm that the provider module received\nthe previously sent ",(0,s.jsx)(n.code,{children:"SlashPacket"})," and it unblocks the sending of the next ",(0,s.jsx)(n.code,{children:"SlashPacket"}),".\nThis functionality is needed for throttling jailing on the provider chain. For more details, see ",(0,s.jsx)(n.a,{href:"/interchain-security/adrs/adr-008-throttle-retries",children:"ADR-008"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"ontimeoutpacket",children:"OnTimeoutPacket"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"OnTimeoutPacket"})," is a no-op."]}),"\n",(0,s.jsx)(n.h2,{id:"messages",children:"Messages"}),"\n",(0,s.jsx)(n.h3,{id:"msgupdateparams",children:"MsgUpdateParams"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"MsgUpdateParams"})," updates the ",(0,s.jsx)(n.a,{href:"#parameters",children:"consumer module parameters"}),".\nThe params are updated through a governance proposal where the signer is the gov module account address."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-proto",children:'message MsgUpdateParams {\n  option (cosmos.msg.v1.signer) = "authority";\n\n  // signer is the address of the governance account.\n  string authority = 1 [(cosmos_proto.scalar) = "cosmos.AddressString"];\n\n  // params defines the x/consumer parameters to update.\n  interchain_security.ccv.v1.ConsumerParams params = 2 [(gogoproto.nullable) = false];\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"beginblock",children:"BeginBlock"}),"\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.code,{children:"BeginBlock"})," of the consumer module the following actions are performed:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Store in state the block height to VSC id mapping needed for sending to the provider the height of infractions committed on the consumer chain."}),"\n",(0,s.jsxs)(n.li,{children:["Track historical entries. This is the same logic as in the ",(0,s.jsx)(n.code,{children:"x/staking"})," module."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"endblock",children:"EndBlock"}),"\n",(0,s.jsxs)(n.p,{children:["In the ",(0,s.jsx)(n.code,{children:"EndBlock"})," of the consumer module the following actions are performed:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If ",(0,s.jsx)(n.code,{children:"PreCCV"})," state is active, i.e., the consumer chain is a previously standalone chain\nthat was just upgraded to include the consumer module, then execute the ",(0,s.jsx)(n.a,{href:"/interchain-security/consumer-development/changeover-procedure",children:"changeover logic"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Otherwise, distribute block rewards internally and once every ",(0,s.jsx)(n.a,{href:"#blocksperdistributiontransmission",children:"BlocksPerDistributionTransmission"})," send\nICS rewards to the provider chain."]}),"\n",(0,s.jsx)(n.li,{children:"Send slash packets to the provider chain reporting infractions validators committed on the consumer chain."}),"\n",(0,s.jsx)(n.li,{children:"Send to the consensus engine validator updates reveived from the provider chain."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"hooks",children:"Hooks"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"TBA"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"events",children:"Events"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"TBA"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"The consumer module parameters are set by the provider when creating the consumer genesis (i.e., when launching the consumer chain).\nAs a result, changes of these parameters might result in incompatibilities between different versions of consumers and providers."})}),"\n",(0,s.jsx)(n.p,{children:"The consumer module contains the following parameters."}),"\n",(0,s.jsx)(n.h3,{id:"enabled",children:"Enabled"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Enabled"})," is deprecated."]}),"\n",(0,s.jsx)(n.h3,{id:"blocksperdistributiontransmission",children:"BlocksPerDistributionTransmission"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"int64"}),(0,s.jsx)(n.td,{children:"1000"})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"BlocksPerDistributionTransmission"})," is the number of blocks between rewards transfers from the consumer to the provider."]}),"\n",(0,s.jsx)(n.h3,{id:"distributiontransmissionchannel",children:"DistributionTransmissionChannel"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:'""'})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"DistributionTransmissionChannel"})," is the provider chain IBC channel used for receiving consumer chain reward distribution token transfers. This is automatically set during the consumer-provider handshake procedure."]}),"\n",(0,s.jsxs)(n.p,{children:["Providing an IBC transfer channel enables a consumer chain to reuse one of the existing channels to the provider for consumer chain rewards distribution.\nThis will preserve the ",(0,s.jsx)(n.code,{children:"ibc denom"})," that may already be in use.\nThis is especially important for standalone chains transitioning to become consumer chains.\nFor more details, see the ",(0,s.jsx)(n.a,{href:"/interchain-security/consumer-development/changeover-procedure",children:"changeover procedure"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"providerfeepooladdrstr",children:"ProviderFeePoolAddrStr"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:'""'})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"ProviderFeePoolAddrStr"})," is the provider chain fee pool address used for receiving consumer chain reward distribution token transfers. This is automatically set during the consumer-provider handshake procedure."]}),"\n",(0,s.jsx)(n.h3,{id:"ccvtimeoutperiod",children:"CcvTimeoutPeriod"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"time.Duration"}),(0,s.jsx)(n.td,{children:"2419200s (4 weeks)"})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"CcvTimeoutPeriod"})," is the period used to compute the timeout timestamp when sending IBC packets.\n",(0,s.jsx)(n.code,{children:"CcvTimeoutPeriod"})," may have different values on the provider and consumer chains."]}),"\n",(0,s.jsx)(n.h3,{id:"transfertimeoutperiod",children:"TransferTimeoutPeriod"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"time.Duration"}),(0,s.jsx)(n.td,{children:"3600s (1 hour)"})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"TransferTimeoutPeriod"})," is the timeout period for consumer chain reward distribution IBC packets."]}),"\n",(0,s.jsx)(n.h3,{id:"consumerredistributionfraction",children:"ConsumerRedistributionFraction"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"string"}),(0,s.jsx)(n.td,{children:'"0.75"'})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"ConsumerRedistributionFraction"})," is the fraction of tokens allocated to the consumer redistribution address during distribution events.\nThe fraction is a string representing a decimal number. For example ",(0,s.jsx)(n.code,{children:'"0.75"'})," would represent ",(0,s.jsx)(n.code,{children:"75%"}),".\nFor example, a consumer with ",(0,s.jsx)(n.code,{children:"ConsumerRedistributionFraction"})," set to ",(0,s.jsx)(n.code,{children:'"0.75"'})," would send ",(0,s.jsx)(n.code,{children:"75%"})," of its block rewards and accumulated fees to the consumer redistribution address, and the remaining ",(0,s.jsx)(n.code,{children:"25%"})," to the provider chain every ",(0,s.jsx)(n.code,{children:"BlocksPerDistributionTransmission"})," blocks."]}),"\n",(0,s.jsx)(n.h3,{id:"historicalentries",children:"HistoricalEntries"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"int64"}),(0,s.jsx)(n.td,{children:"10000"})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"HistoricalEntries"})," is the number of historical info entries to persist in store (see the staking module parameter with the same name for details).\n",(0,s.jsx)(n.code,{children:"HistoricalEntries"})," is needed since the consumer module acts as a staking module on the consumer chain."]}),"\n",(0,s.jsx)(n.h3,{id:"unbondingperiod",children:"UnbondingPeriod"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"time.Duration"}),(0,s.jsx)(n.td,{children:"1209600s (2 weeks)"})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"UnbondingPeriod"})," is the unbonding period on the consumer chain.\nIt is recommended that every consumer chain set and unbonding period shorter than provider unbonding period, e.g., one week shorter."]}),"\n",(0,s.jsx)(n.h3,{id:"softoptoutthreshold",children:"SoftOptOutThreshold"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"SoftOptOutThreshold"})," is deprecated."]}),"\n",(0,s.jsx)(n.h3,{id:"rewarddenoms",children:"RewardDenoms"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"[]string"}),(0,s.jsx)(n.td,{children:"[]string"})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"RewardDenoms"})," are the denominations which are allowed to be sent to the provider as ICS rewards."]}),"\n",(0,s.jsx)(n.h3,{id:"providerrewarddenoms",children:"ProviderRewardDenoms"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"[]string"}),(0,s.jsx)(n.td,{children:"[]string"})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"ProviderRewardDenoms"}),' are the denominations coming from the provider which are allowed to be used as ICS rewards. e.g. "uatom".']}),"\n",(0,s.jsx)(n.h3,{id:"retrydelayperiod",children:"RetryDelayPeriod"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default value"})]})}),(0,s.jsx)(n.tbody,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"time.Duration"}),(0,s.jsx)(n.td,{children:"3600s (1 hour)"})]})})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"RetryDelayPeriod"})," is the period at which the consumer retries to send a ",(0,s.jsx)(n.code,{children:"SlashPacket"})," that was rejected by the provider.\nFor more details, see ",(0,s.jsx)(n.a,{href:"/interchain-security/adrs/adr-008-throttle-retries",children:"ADR-008"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"client",children:"Client"}),"\n",(0,s.jsx)(n.h3,{id:"cli",children:"CLI"}),"\n",(0,s.jsxs)(n.p,{children:["A user can interact with the ",(0,s.jsx)(n.code,{children:"consumer"})," module using the CLI."]}),"\n",(0,s.jsx)(n.h4,{id:"query",children:"Query"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"query"})," commands allow users to query ",(0,s.jsx)(n.code,{children:"consumer"})," state."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain-security-cd query ccvconsumer --help\n"})}),"\n",(0,s.jsx)(n.h5,{id:"next-fee-distribution",children:"Next Fee Distribution"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"next-fee-distribution"})," command allows to query next fee distribution data."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain-security-cd query ccvconsumer next-fee-distribution [flags]\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain-security-cd query ccvconsumer next-fee-distribution\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'data:\n  currentHeight: "967"\n  distribution_fraction: "0.75"\n  lastHeight: "960"\n  nextHeight: "980"\n  toConsumer: ""\n  toProvider: ""\n  total: ""\n'})})]}),"\n",(0,s.jsx)(n.h5,{id:"provider-info",children:"Provider Info"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"provider-info"})," command allows to query provider info."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain-security-cd query ccvconsumer provider-info [flags]\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain-security-cd query ccvconsumer provider-info\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"consumer:\n  chainID: pion-1\n  channelID: channel-0\n  clientID: 07-tendermint-0\n  connectionID: connection-0\nprovider:\n  chainID: provider\n  channelID: channel-0\n  clientID: 07-tendermint-0\n  connectionID: connection-0\n"})})]}),"\n",(0,s.jsx)(n.h5,{id:"throttle-state",children:"Throttle State"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"throttle-state"})," command allows to query on-chain state relevant with slash packet throttling."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain-security-cd query ccvconsumer throttle-state [flags]\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain-security-cd query ccvconsumer throttle-state\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'packet_data_queue:\n- slashPacketData:\n    infraction: INFRACTION_DOWNTIME\n    validator:\n      address: mb06cu8SzQJOdYSzrJAK43Q8at8=\n      power: "500"\n    valset_update_id: "48"\n  type: CONSUMER_PACKET_TYPE_SLASH\nslash_record:\n  send_time: "2024-10-02T07:58:24.405645924Z"\n  waiting_on_reply: true\n'})})]}),"\n",(0,s.jsx)(n.h5,{id:"params",children:"Params"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"params"})," command allows to query consumer module parameters."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain-security-cd query ccvconsumer params [flags]\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain-security-cd query ccvconsumer params\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'params:\n  blocks_per_distribution_transmission: "1000"\n  ccv_timeout_period: 2419200s\n  consumer_id: "0"\n  consumer_redistribution_fraction: "0.75"\n  distribution_transmission_channel: channel-1\n  enabled: true\n  historical_entries: "10000"\n  provider_fee_pool_addr_str: cosmos1ap0mh6xzfn8943urr84q6ae7zfnar48am2erhd\n  provider_reward_denoms: []\n  retry_delay_period: 3600s\n  reward_denoms: []\n  soft_opt_out_threshold: "0"\n  transfer_timeout_period: 3600s\n  unbonding_period: 1209600s\n'})})]}),"\n",(0,s.jsx)(n.h3,{id:"grpc",children:"gRPC"}),"\n",(0,s.jsxs)(n.p,{children:["A user can query the ",(0,s.jsx)(n.code,{children:"consumer"})," module using gRPC endpoints."]}),"\n",(0,s.jsx)(n.h4,{id:"next-fee-distribution-1",children:"Next Fee Distribution"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"QueryNextFeeDistribution"})," endpoint queries next fee distribution data."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain_security.ccv.consumer.v1.Query/QueryNextFeeDistribution\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"grpcurl -plaintext localhost:9090 interchain_security.ccv.consumer.v1.Query/QueryNextFeeDistribution\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "currentHeight": "402",\n    "lastHeight": "400",\n    "nextHeight": "420",\n    "distributionFraction": "0.75"\n  }\n}\n'})})]}),"\n",(0,s.jsx)(n.h4,{id:"provider-info-1",children:"Provider Info"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"QueryProviderInfo"})," endpoint queries provider info."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain_security.ccv.consumer.v1.Query/QueryProviderInfo\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"grpcurl -plaintext localhost:9090 interchain_security.ccv.consumer.v1.Query/QueryProviderInfo\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "consumer": {\n    "chainID": "pion-1",\n    "clientID": "07-tendermint-0",\n    "connectionID": "connection-0",\n    "channelID": "channel-0"\n  },\n  "provider": {\n    "chainID": "provider",\n    "clientID": "07-tendermint-0",\n    "connectionID": "connection-0",\n    "channelID": "channel-0"\n  }\n}\n'})})]}),"\n",(0,s.jsx)(n.h4,{id:"throttle-state-1",children:"Throttle State"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"QueryThrottleState"})," endpoint queries on-chain state relevant with slash packet throttling."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain_security.ccv.consumer.v1.Query/QueryThrottleState\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"grpcurl -plaintext localhost:9090 interchain_security.ccv.consumer.v1.Query/QueryThrottleState\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "slashRecord": {\n    "waitingOnReply": true,\n    "sendTime": "2024-10-02T07:58:24.405645924Z"\n  },\n  "packetDataQueue": [\n    {\n      "type": "CONSUMER_PACKET_TYPE_SLASH",\n      "slashPacketData": {\n        "validator": {\n          "address": "mb06cu8SzQJOdYSzrJAK43Q8at8=",\n          "power": "500"\n        },\n        "valsetUpdateId": "48",\n        "infraction": "INFRACTION_DOWNTIME"\n      }\n    }\n  ]\n}\n'})})]}),"\n",(0,s.jsx)(n.h4,{id:"params-1",children:"Params"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"QueryParams"})," endpoint queries consumer module parameters."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"interchain_security.ccv.consumer.v1.Query/QueryParams\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"grpcurl -plaintext localhost:9090 interchain_security.ccv.consumer.v1.Query/QueryParams\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "params": {\n    "enabled": true,\n    "blocksPerDistributionTransmission": "1000",\n    "distributionTransmissionChannel": "channel-1",\n    "providerFeePoolAddrStr": "cosmos1ap0mh6xzfn8943urr84q6ae7zfnar48am2erhd",\n    "ccvTimeoutPeriod": "2419200s",\n    "transferTimeoutPeriod": "3600s",\n    "consumerRedistributionFraction": "0.75",\n    "historicalEntries": "10000",\n    "unbondingPeriod": "1209600s",\n    "softOptOutThreshold": "0",\n    "retryDelayPeriod": "3600s",\n    "consumerId": "0"\n  }\n}\n'})})]}),"\n",(0,s.jsx)(n.h3,{id:"rest",children:"REST"}),"\n",(0,s.jsxs)(n.p,{children:["A user can query the ",(0,s.jsx)(n.code,{children:"consumer"})," module using REST endpoints."]}),"\n",(0,s.jsx)(n.h4,{id:"next-fee-distribution-2",children:"Next Fee Distribution"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"next-fee-distribution"})," endpoint queries next fee distribution data."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/interchain_security/ccv/consumer/next-fee-distribution\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:1317/interchain_security/ccv/consumer/next-fee-distribution\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "currentHeight": "402",\n    "lastHeight": "400",\n    "nextHeight": "420",\n    "distributionFraction": "0.75"\n  }\n}\n'})})]}),"\n",(0,s.jsx)(n.h4,{id:"provider-info-2",children:"Provider Info"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"QueryProviderInfo"})," endpoint queries provider info."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/interchain_security/ccv/consumer/provider-info\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:1317/interchain_security/ccv/consumer/provider-info\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "consumer": {\n    "chainID": "pion-1",\n    "clientID": "07-tendermint-0",\n    "connectionID": "connection-0",\n    "channelID": "channel-0"\n  },\n  "provider": {\n    "chainID": "provider",\n    "clientID": "07-tendermint-0",\n    "connectionID": "connection-0",\n    "channelID": "channel-0"\n  }\n}\n'})})]}),"\n",(0,s.jsx)(n.h4,{id:"throttle-state-2",children:"Throttle State"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"throttle_state"})," endpoint queries on-chain state relevant with slash packet throttling."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/interchain_security/ccv/consumer/throttle_state\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:1317/interchain_security/ccv/consumer/throttle_state\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "consumer": {\n    "chainID": "pion-1",\n    "clientID": "07-tendermint-0",\n    "connectionID": "connection-0",\n    "channelID": "channel-0"\n  },\n  "provider": {\n    "chainID": "provider",\n    "clientID": "07-tendermint-0",\n    "connectionID": "connection-0",\n    "channelID": "channel-0"\n  }\n}\n'})})]}),"\n",(0,s.jsx)(n.h4,{id:"params-2",children:"Params"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"params"})," endpoint queries consumer module parameters."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"/interchain_security/ccv/consumer/params\n"})}),"\n",(0,s.jsxs)(i,{children:[(0,s.jsx)("summary",{children:"Example"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:1317/interchain_security/ccv/consumer/params\n"})}),(0,s.jsx)(n.p,{children:"Output:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "params": {\n    "enabled": true,\n    "blocksPerDistributionTransmission": "1000",\n    "distributionTransmissionChannel": "channel-1",\n    "providerFeePoolAddrStr": "cosmos1ap0mh6xzfn8943urr84q6ae7zfnar48am2erhd",\n    "ccvTimeoutPeriod": "2419200s",\n    "transferTimeoutPeriod": "3600s",\n    "consumerRedistributionFraction": "0.75",\n    "historicalEntries": "10000",\n    "unbondingPeriod": "1209600s",\n    "softOptOutThreshold": "0",\n    "retryDelayPeriod": "3600s",\n    "consumerId": "0"\n  }\n}\n'})})]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>d});var s=i(7294);const r={},t=s.createContext(r);function d(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);