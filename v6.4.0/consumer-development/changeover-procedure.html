<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-v6.4.0 docs-doc-page docs-doc-id-consumer-development/changeover-procedure" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Changeover Procedure | Interchain Security</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://cosmos.github.io/interchain-security/img/banner.png"><meta data-rh="true" name="twitter:image" content="https://cosmos.github.io/interchain-security/img/banner.png"><meta data-rh="true" property="og:url" content="https://cosmos.github.io/interchain-security/v6.4.0/consumer-development/changeover-procedure"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="v6.4.0"><meta data-rh="true" name="docusaurus_tag" content="docs-default-v6.4.0"><meta data-rh="true" name="docsearch:version" content="v6.4.0"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-v6.4.0"><meta data-rh="true" property="og:title" content="Changeover Procedure | Interchain Security"><meta data-rh="true" name="description" content="Chains that were not initially launched as consumers of Interchain Security can still participate in the protocol and leverage the economic security of the provider chain. The process where a standalone chain transitions to being a consumer chain is called the changeover procedure and is part of the Interchain Security protocol. After the changeover, the new consumer chain will retain all existing state, including the IBC clients, connections and channels already established by the chain."><meta data-rh="true" property="og:description" content="Chains that were not initially launched as consumers of Interchain Security can still participate in the protocol and leverage the economic security of the provider chain. The process where a standalone chain transitions to being a consumer chain is called the changeover procedure and is part of the Interchain Security protocol. After the changeover, the new consumer chain will retain all existing state, including the IBC clients, connections and channels already established by the chain."><link data-rh="true" rel="icon" href="/interchain-security/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://cosmos.github.io/interchain-security/v6.4.0/consumer-development/changeover-procedure"><link data-rh="true" rel="alternate" href="https://cosmos.github.io/interchain-security/v6.4.0/consumer-development/changeover-procedure" hreflang="en"><link data-rh="true" rel="alternate" href="https://cosmos.github.io/interchain-security/v6.4.0/consumer-development/changeover-procedure" hreflang="x-default"><link rel="stylesheet" href="/interchain-security/assets/css/styles.5e0b2b97.css">
<script src="/interchain-security/assets/js/runtime~main.7a460333.js" defer="defer"></script>
<script src="/interchain-security/assets/js/main.e0613764.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/interchain-security/"><div class="navbar__logo"><img src="/interchain-security/img/hub.svg" alt="Interchain Security Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/interchain-security/img/hub.svg" alt="Interchain Security Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Interchain Security</b></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/interchain-security/v6.4.0">v6.4.0</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/interchain-security/consumer-development/changeover-procedure">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/interchain-security/v6.4.0/consumer-development/changeover-procedure">v6.4.0</a></li><li><a class="dropdown__link" href="/interchain-security/v6.3.0/consumer-development/changeover-procedure">v6.3.0</a></li><li><a class="dropdown__link" href="/interchain-security/v6.1.0/consumer-development/changeover-procedure">v6.1.0</a></li><li><a class="dropdown__link" href="/interchain-security/v5.2.0/consumer-development/changeover-procedure">v5.2.0</a></li><li><a class="dropdown__link" href="/interchain-security/v4.5.0/consumer-development/changeover-procedure">v4.5.0</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cosmos/interchain-security" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="github-icon">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M12 0.300049C5.4 0.300049 0 5.70005 0 12.3001C0 17.6001 3.4 22.1001 8.2 23.7001C8.8 23.8001 9 23.4001 9 23.1001C9 22.8001 9 22.1001 9 21.1001C5.7 21.8001 5 19.5001 5 19.5001C4.5 18.1001 3.7 17.7001 3.7 17.7001C2.5 17.0001 3.7 17.0001 3.7 17.0001C4.9 17.1001 5.5 18.2001 5.5 18.2001C6.6 20.0001 8.3 19.5001 9 19.2001C9.1 18.4001 9.4 17.9001 9.8 17.6001C7.1 17.3001 4.3 16.3001 4.3 11.7001C4.3 10.4001 4.8 9.30005 5.5 8.50005C5.5 8.10005 5 6.90005 5.7 5.30005C5.7 5.30005 6.7 5.00005 9 6.50005C10 6.20005 11 6.10005 12 6.10005C13 6.10005 14 6.20005 15 6.50005C17.3 4.90005 18.3 5.30005 18.3 5.30005C19 7.00005 18.5 8.20005 18.4 8.50005C19.2 9.30005 19.6 10.4001 19.6 11.7001C19.6 16.3001 16.8 17.3001 14.1 17.6001C14.5 18.0001 14.9 18.7001 14.9 19.8001C14.9 21.4001 14.9 22.7001 14.9 23.1001C14.9 23.4001 15.1 23.8001 15.7 23.7001C20.5 22.1001 23.9 17.6001 23.9 12.3001C24 5.70005 18.6 0.300049 12 0.300049Z" fill="currentColor"/>
            </svg>
            </a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/interchain-security/v6.4.0">Cosmos Hub - Interchain Security</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/interchain-security/v6.4.0/introduction/overview">Introduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/interchain-security/v6.4.0/features/key-assignment">Features</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/interchain-security/v6.4.0/build/modules/overview">Build</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/interchain-security/v6.4.0/consumer-development/create-with-spawn">Consumer Guide</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/interchain-security/v6.4.0/consumer-development/create-with-spawn">Create an ICS chain with Spawn</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/interchain-security/v6.4.0/consumer-development/app-integration">Developing an ICS consumer chain</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/interchain-security/v6.4.0/consumer-development/consumer-chain-governance">Consumer Chain Governance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/interchain-security/v6.4.0/consumer-development/onboarding">Onboarding Checklist</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/interchain-security/v6.4.0/consumer-development/offboarding">Offboarding Checklist</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/interchain-security/v6.4.0/consumer-development/changeover-procedure">Changeover Procedure</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/interchain-security/v6.4.0/consumer-development/consumer-genesis-transformation">Consumer Genesis Transformation</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/interchain-security/v6.4.0/validators/overview">Validators Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/interchain-security/v6.4.0/integrators/integrating_inactive_validators">Integrators Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/interchain-security/v6.4.0/adrs/intro">ADRs</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/interchain-security/v6.4.0/faq">Frequently Asked Questions</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Interchain Security<!-- --> <b>v6.4.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/interchain-security/consumer-development/changeover-procedure">latest version</a></b> (<!-- -->Next<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/interchain-security/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Consumer Guide</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Changeover Procedure</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: v6.4.0</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Changeover Procedure</h1>
<p>Chains that were <strong>not</strong> initially launched as consumers of Interchain Security can still participate in the protocol and leverage the economic security of the provider chain. The process where a standalone chain transitions to being a consumer chain is called the <strong>changeover procedure</strong> and is part of the Interchain Security protocol. After the changeover, the new consumer chain will retain all existing state, including the IBC clients, connections and channels already established by the chain.</p>
<p>In a nutshell, to become an ICS consumer chain, a standalone chain needs to add the <code>x/ccv/consumer</code> module (via a coordinated upgrade) and to transfer validation responsibilities to the provider validators as stated in <code>consumer_genesis.json</code>.</p>
<p>The relevant protocol specifications are available below:</p>
<ul>
<li><a href="https://github.com/cosmos/ibc/blob/main/spec/app/ics-028-cross-chain-validation/overview_and_basic_concepts.md#channel-initialization-existing-chains" target="_blank" rel="noopener noreferrer">ICS-28 with existing chains</a>.</li>
<li><a href="/interchain-security/v6.4.0/adrs/adr-010-standalone-changeover">ADR in ICS repo</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="consumers-on-ics-version-v640">Consumers on ICS Version <code>v6.4.0+</code><a href="#consumers-on-ics-version-v640" class="hash-link" aria-label="Direct link to consumers-on-ics-version-v640" title="Direct link to consumers-on-ics-version-v640">​</a></h2>
<p>For chains that are using ICS <code>v6.4.0</code> or newer, the standalone to consumer changeover consists of the following steps.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-a-new-consumer-chain-on-the-provider">1. Create a new consumer chain on the provider<a href="#1-create-a-new-consumer-chain-on-the-provider" class="hash-link" aria-label="Direct link to 1. Create a new consumer chain on the provider" title="Direct link to 1. Create a new consumer chain on the provider">​</a></h3>
<p>Submit a <code>MsgCreateConsumer</code> message to the provider chain. This is a &quot;normal&quot; <a href="/interchain-security/v6.4.0/build/modules/provider#msgcreateconsumer">MsgCreateConsumer message</a> as described in the <a href="/interchain-security/v6.4.0/consumer-development/onboarding">onboarding checklist</a>, but with the following important notes.</p>
<ul>
<li>
<p><code>chain_id</code> <strong>MUST</strong> be equal to the standalone chain id.</p>
</li>
<li>
<p>The consumer initialization parameters (i.e., <code>initialization_parameters</code>) must be adapted for the changeover procedure:</p>
<ul>
<li><code>initial_height</code> is not used as the provider uses an existing client of the standalone chain..</li>
<li><code>spawn_time</code> is the time on the provider when the consumer module genesis state is being generated,
which means that at this time the provide creates the initial validator set that will validate the standalone chain once it becomes a consumer chain.
Consequently, <code>spawn_time</code> <strong>MUST</strong> occur before the standalone chain is upgraded and the consumer module is added as the upgrade requires the consumer module genesis state.</li>
<li><code>unbonding_period</code> <strong>MUST</strong> correspond to the value used on the standalone chain.</li>
<li><code>distribution_transmission_channel</code> <strong>SHOULD</strong> be set to the canonical IBC token transfer channel between the provider and the standalone chain. This will preserve the <code>ibc denom</code> that may already be in use.</li>
<li><code>connection_id</code> <strong>MUST</strong> be set to the ID of the connection end on the provider chain on top of which the canonical IBC token transfer channel was created.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-add-consumer-module-to-standalone-chain">2. Add consumer module to standalone chain<a href="#2-add-consumer-module-to-standalone-chain" class="hash-link" aria-label="Direct link to 2. Add consumer module to standalone chain" title="Direct link to 2. Add consumer module to standalone chain">​</a></h3>
<p>The standalone chain <strong>MUST</strong> go through an upgrade to include the <code>x/ccv/consumer</code> module.
Note that adding the <code>x/ccv/consumer</code> module requires the consumer module genesis state which is created by the provider at <code>spawn_time</code>.
Consequently, the <code>spawn_time</code> <strong>MUST</strong> occur before this upgrade.</p>
<p>Note that the consumer module genesis state can be obtained from the provider using the <a href="/interchain-security/v6.4.0/build/modules/provider#consumer-genesis">consumer genesis query</a>, i.e.,</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">interchain-security-pd query provider consumer-genesis [consumer-id] [flags]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The consumer genesis state must be exported to a file and placed in the correct folder on the standalone chain before the upgrade.
The file must be placed at the exact specified location, otherwise the upgrade will not be executed correctly.
Usually the file is placed in <code>$NODE_HOME/config</code>, but the file name and the exact directory is dictated by the upgrade code on the <code>standalone</code> chain.</p>
<p>After the <code>consumer_genesis.json</code> file has been made available, the process is equivalent to a normal on-chain upgrade. The standalone validator set will sign the next couple of blocks before transferring control to the initial ICS validator set.</p>
<p>Once upgraded, the <code>x/ccv/consumer</code> module will act as the &quot;staking module&quot; for the consumer chain, i.e., it will provide the validator set to the consensus engine. For staking a native token (e.g., for governance), the <code>x/ccv/democracy/staking</code> module allows the cosmos-sdk <code>x/staking</code> module to be used alongside the <code>x/ccv/consumer</code> module. For more details, check out the <a href="/interchain-security/v6.4.0/build/modules/democracy">democracy modules</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="consumers-on-ics-version--v640">Consumers on ICS Version <code>&lt; v6.4.0</code><a href="#consumers-on-ics-version--v640" class="hash-link" aria-label="Direct link to consumers-on-ics-version--v640" title="Direct link to consumers-on-ics-version--v640">​</a></h2>
<p>Chains that are using older version of ICS (i.e., <code>&lt; v6.4.0</code>), must &quot;force&quot; the provider to create a new client of the standalone chain (on top of which the CCV channel will be created).
This is because older versions of the consumer module expects both a client state and a consensus state in order to create a new provider client.
Therefore, when creating a new consumer chain on the provider, the following changes are necessary in the consumer initialization parameters:</p>
<ul>
<li><code>connection_id</code> <strong>MUST</strong> be set to an empty string (i.e., <code>&quot;&quot;</code>). As a result, the provider will create a new client of the consumer chain and a new connection on top of it.</li>
<li><code>initial_height</code> will be used by the provider when creating the new consumer client, so it <strong>MUST</strong> be set according to the following rules:<!-- -->
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;initial_height&quot; : {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // must correspond to current revision number of standalone chain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // e.g. stride-1 =&gt; &quot;revision_number&quot;: 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;revision_number&quot;: 1,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // must correspond to a height that is at least 1 block after the upgrade</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // that will add the `consumer` module to the standalone chain</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // e.g. &quot;upgrade_height&quot;: 100 =&gt; &quot;revision_height&quot;: 101</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &quot;revision_height&quot;: 101,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">},</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="adapt-the-consumer-module-genesis-state">Adapt the consumer module genesis state<a href="#adapt-the-consumer-module-genesis-state" class="hash-link" aria-label="Direct link to Adapt the consumer module genesis state" title="Direct link to Adapt the consumer module genesis state">​</a></h3>
<p>Before the upgrade of the standalone chain (i.e., adding the <code>x/ccv/consumer</code> module), the consumer module genesis state created by the provider at <code>spawn_time</code> must be adapted to older versions of the consumer module. This consists of two changes.</p>
<p>First, by setting <code>connection_id</code> in the consumer initialization parameters to an empty string, the provider will set the <code>preCCV</code> flag in the <code>ConsumerGenesisState</code> struct to <code>false</code>. This must be changed to <code>true</code> in order to trigger the changeover procedure logic on the <code>x/ccv/consumer</code> module.</p>
<p>Second, the <code>connection_id</code> field of <code>ConsumerGenesisState</code> must be removed to enable older versions of the consumer module to unmarshal the consumer module genesis state obtained from the provider. This can be done using the <code>interchain-security-cd genesis transform</code> CLI command.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/interchain-security/v6.4.0/consumer-development/offboarding"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Offboarding Checklist</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/interchain-security/v6.4.0/consumer-development/consumer-genesis-transformation"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Consumer Genesis Transformation</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#consumers-on-ics-version-v640" class="table-of-contents__link toc-highlight">Consumers on ICS Version <code>v6.4.0+</code></a><ul><li><a href="#1-create-a-new-consumer-chain-on-the-provider" class="table-of-contents__link toc-highlight">1. Create a new consumer chain on the provider</a></li><li><a href="#2-add-consumer-module-to-standalone-chain" class="table-of-contents__link toc-highlight">2. Add consumer module to standalone chain</a></li></ul></li><li><a href="#consumers-on-ics-version--v640" class="table-of-contents__link toc-highlight">Consumers on ICS Version <code>&lt; v6.4.0</code></a><ul><li><a href="#adapt-the-consumer-module-genesis-state" class="table-of-contents__link toc-highlight">Adapt the consumer module genesis state</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://cosmos.network"><img src="/interchain-security/img/logo-bw.svg" alt="Interchain Security Logo"></a></li></ul></div><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://hub.cosmos.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cosmos Hub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.cosmos.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cosmos SDK<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docs.tendermint.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tendermint Core<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://ibc.cosmos.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">IBC Go<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://blog.cosmos.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.cosmos.network" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/cosmosnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://reddit.com/r/cosmosnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Reddit<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/cosmosnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/cosmos" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/c/CosmosProject" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://t.me/cosmosproject" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">The development of Interchain Security is primarily led by Informal Systems. Funding for this development comes primarily from the Interchain Foundation, a Swiss non-profit.</div></div></div></footer></div>
</body>
</html>